steps:
  # Install dependencies
  - name: python
    entrypoint: pip
    args: ["install", "-r", "requirements.txt", "--user"]

  # Check import formatting
  - name: python
    entrypoint: python
    args: ["-m", "isort", "--check", "app"]

  # Check formatting
  - name: python
    entrypoint: python
    args: ["-m", "black", "--check", "app"]

  # Check formatting
  - name: python
    entrypoint: python
    args: ["-m", "pylint", "app"]

  # Run tests
  - name: python
    entrypoint: python
    args: ["-m", "pytest"]
  

  - name: "gcr.io/cloud-builders/gcloud"
    entrypoint: bash
    args: ["if", "[ $BRANCH_NAME == 'main' ];", "then", "app", "deploy;", "fi"]

timeout: "1600s"