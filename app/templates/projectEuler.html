{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/styles/default.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/highlight.min.js"></script>

<table style="width: 80%">
{% for i in range(10) %}
	<tr>
	{% for j in range(1, 11) %}
		{% set cellNumber=10*i + j %}
		<td>
			{% if cellNumber in solvedProblems %}
			<button class="requestExercise{{cellNumber}}", style="width: 100%; background-color: #51d14b">
				{{cellNumber}}
			</button>
			{% else %}
			<button class="requestExercise{{cellNumber}}", style="width: 100%; background-color: #d14b4b">
				{{cellNumber}}
			</button>
			{% endif %}
		</td>
	{% endfor %}
	</tr>
{% endfor %}
</table>

<div>
	<h3 class="exerciseTitle"></h3>
	<div class="exerciseSource"></div>
	<div>
		<button class="runCode">Run Code!</button>
		<h4 class="solution"></h4>
	</div>
</div>

{% for problem in solvedProblems %}
		{% set filename="js/exerciseSolutions/exercise" + problem|string +".js" %}
		<script type="module">
			
			import loadFile from "{{ url_for('static', filename='js/libraryFunctions/fileLoading.js') }}";
			import exercise{{problem}} from "{{ url_for('static', filename=filename) }}";

			const requestButton{{problem}} = document.querySelector('.requestExercise{{problem}}');

			const source = document.querySelector('.exerciseSource');
			const title = document.querySelector('.exerciseTitle');
			const solution = document.querySelector('.solution');
			const runCodeButton = document.querySelector('.runCode');

			function displayCode()
			{
				title.innerText = "Exercise {{ problem }}" 
				source.innerHTML = '<pre><code class="javascript">'+loadFile("{{ url_for('static', filename=filename) }}")+'</code></pre>';
				document.querySelectorAll('pre code').forEach((block) => {
					hljs.highlightBlock(block);
				});

				function displayAnswer()
				{
					
					solution.innerText = exercise{{problem}}();

				}

				solution.innerText = ""
				runCodeButton.addEventListener('click', displayAnswer);

			}

			requestButton{{problem}}.addEventListener('click', displayCode);

		</script>
{% endfor %}
{% endblock %}